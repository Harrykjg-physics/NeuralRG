import numpy as np

import matplotlib.pyplot as plt

T = np.array([2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0,3.1,3.2,3.3,3.4,3.5])

loss4 = np.array([-2641.624267578125,-2527.27001953125,-2423.921875,-2330.166259765625,-2245.9599609375,-2170.16943359375,-2101.348388671875,-2039.4549560546875,-1983.98828125,-1933.54541015625,-1887.2259521484375,-1843.9595947265625,-1802.8082275390625,-1763.9700927734375,-1727.15185546875,-1692.199462890625])
error4 = np.array([3.5897133350372314,3.7522597312927246,3.916285514831543,4.091137886047363,4.128561019897461,4.1912617683410645,4.417384624481201,4.977357864379883,5.669755458831787,6.153363227844238,5.559885025024414,4.948153495788574,4.600318431854248,4.27043342590332,4.0430073738098145,3.792742967605591])

loss3 = np.array([-2641.483642578125,-2527.185546875,-2423.8017578125,-2330.20556640625,-2245.9208984375,-2170.05029296875,-2101.366943359375,-2039.4560546875,-1984.015625,-1933.61083984375,-1887.1900634765625,-1843.6483154296875,-1802.592529296875,-1763.86572265625,-1726.961181640625,-1692.1348876953125])
error3 = np.array([3.6358187198638916,3.787550926208496,3.954665422439575,4.138251304626465,4.126420974731445,4.2026777267456055,4.3766632080078125,4.93649435043335,5.67787504196167,6.05204439163208,5.493767738342285,4.987216472625732,4.625535488128662,4.218703269958496,4.036411285400391,3.817873477935791])

loss2 = np.array([-2640.94873046875,-2526.707763671875,-2423.1708984375,-2329.6982421875,-2245.55810546875,-2169.4765625,-2100.65234375,-2038.833740234375,-1983.5267333984375,-1933.0726318359375,-1886.74560546875,-1843.1339111328125,-1802.19189453125,-1763.463623046875,-1726.7359619140625,-1691.88232421875])
error2 = np.array([3.7708935737609863,3.9753758907318115,4.291398048400879,4.390312671661377,4.430959701538086,4.468678951263428,4.468613147735596,4.867430210113525,5.530463695526123,6.031662464141846,5.609684467315674,5.22866678237915,4.845409870147705,4.538459777832031,4.196757793426514,3.8964390754699707])

loss1 = np.array([-2630.282958984375,-2516.745361328125,-2414.240478515625,-2321.435546875,-2237.48681640625,-2162.234375,-2093.994140625,-2032.4127197265625,-1978.0548095703125,-1928.4437255859375,-1882.3209228515625,-1839.25439453125,-1798.2760009765625,-1759.5277099609375,-1722.482177734375,-1687.7078857421875])
error1 = np.array([7.287839412689209,7.025932788848877,6.802257537841797,6.532965660095215,6.355715274810791,6.483624458312988,6.582297325134277,6.584652900695801,6.786789894104004,6.893899440765381,6.552390098571777,6.233702659606934,5.940138816833496,5.638521671295166,5.487260341644287,5.358496189117432])

exact = np.array([1051.104987614517,1009.4996784717939,973.8408186679096,944.3823241807323,920.8489585246118,901.1617063065412,884.3618952526879,869.8418508112793,857.1705412103629,846.0253831110782,836.1570646028667,827.3685472309867,819.5014489849076,812.4267256294704,806.0380467741903,800.2469515985453])

fix = np.array([1597.682970064889,1525.9571863911228,1459.8057676137014,1398.5480483845513,1341.612857520735,1288.5170967249728,1238.8491888829687,1192.2561471669637,1148.4333700194834,1107.1165118352076,1068.0749509785837,1031.1064990650011,996.0330835834103,962.697200232009,930.958978748977,900.6937413401133])

res1 = np.abs(-loss1-exact-fix)
res2 = np.abs(-loss2-exact-fix)
res3 = np.abs(-loss3-exact-fix)
res4 = np.abs(-loss4-exact-fix)

error4 /= (512)**0.5
error3 /= (512)**0.5
error2 /= (512)**0.5
error1 /= (512)**0.5

plt.errorbar(T,res1,label="depth = 1",yerr=error1)
plt.errorbar(T,res2,label="depth = 2",yerr=error2)
plt.errorbar(T,res3,label="depth = 3",yerr=error3)
plt.errorbar(T,res4,label="depth = 4",yerr=error4)

plt.legend()
plt.xlabel("Temperature")
plt.ylabel("$|loss-lnZ|$")

plt.show()


import pdb
pdb.set_trace()