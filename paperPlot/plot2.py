import numpy as np

import matplotlib.pyplot as plt

T = np.array([2.0,2.1,2.2,2.269185314213022,2.3,2.4,2.5])

loss4 = -np.array([660.2081909179688,631.5170288085938,605.5825805664062,589.0599975585938,582.0547485351562,560.6903076171875,541.2244262695312])

loss3 = -np.array([660.20703125,631.51416015625,605.5714721679688,589.0440063476562,582.0383911132812,560.6741333007812,541.2250366210938])

loss2 = -np.array([659.947998046875,631.2799072265625,605.333740234375,588.8079833984375,581.794677734375,560.4230346679688,541.0206909179688])

loss1 = -np.array([657.3002319335938,628.7518920898438,603.01513671875,586.5538940429688,579.55712890625,558.235595703125,539.0263061523438])

exact = np.array([263.29621043402125,252.8952741554581,243.9756979903575,238.64225663513287,236.59802766605696,230.73226236763298,225.81063208450638])

fix = np.array([399.418793393396,381.48763983688104,364.9500280838529,354.2334832224499,349.63580114185936,335.4021735990462,322.1283767570811])

res1 = np.abs(-loss1-exact-fix)/(exact+fix)
res2 = np.abs(-loss2-exact-fix)/(exact+fix)
res3 = np.abs(-loss3-exact-fix)/(exact+fix)
res4 = np.abs(-loss4-exact-fix)/(exact+fix)

plt.plot(T,res1,label="depth = 1")
plt.plot(T,res2,label="depth = 2")
plt.plot(T,res3,label="depth = 3")
plt.plot(T,res4,label="depth = 4")

plt.legend()

plt.xlabel("Temperature")
plt.ylabel("$|loss-exact lnZ|/exact lnZ$")

plt.show()


import pdb
pdb.set_trace()